
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>AltoroJ_Ant - Findings By Fix Group Report</title><link type="text/css" rel="stylesheet" href="resource/style.css"/><link type="text/css" rel="stylesheet" href="resource/styleDisplay.css"/><script type="text/javascript" src="resource/functions.js"><!--comment inserted for Internet Explorer--></script><script type="text/javascript" src="resource/dojo.js"><!--comment inserted for Internet Explorer--></script><script type="text/javascript">var plusIcon = 'resource/images/foldingPlus.gif'; var minusIcon = 'resource/images/foldingMinus.gif';</script></head><body><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td><table cellpadding="0" cellspacing="0" width="100%"><tr><td width="1280"><img src="resource/images/IBM_ban_FindRept_1280x42.gif" width="100%" height="42" alt=""/></td><td width="88"><img src="resource/images/IBM_ban_rght-margin-88x42.gif" width="100%" height="42" alt=""/></td></tr></table></td></tr></table><table width="100%"><tr><td class="reportTitle" rowspan="2">AltoroJ_Ant - Findings By Fix Group Report</td><td align="right">
                        
                    Scan Date: Jul 20, 2021 9:47:55 PM</td></tr><tr><td align="right">
                    
                    Report Generated: Jul 20, 2021 9:50:34 PM</td></tr></table><div class="findingHeader">Common API Call: Authentication.Entity</div><div class="fixGroupDivergenceAPI">java.sql.DriverManager.getConnection(java.lang.String):java.sql.Connection</div><table width="100%"><tbody><tr vAlign="middle" align="left" bgColor="#444444"><th bgColor="white" width="1"/><th class="VulnTableHeader" width="40">Classification</th><th class="VulnTableHeader" width="40">Type</th><th class="VulnTableHeader" width="50">Severity</th><th class="VulnTableHeader" width="300">File</th><th class="VulnTableHeader" width="40" align="right">Line</th><th class="VulnTableHeader" width="75" align="right">CWE ID</th><th class="VulnTableHeader" width="75">Trace</th><th class="VulnTableHeader" width="75">Notes</th></tr><tr><td><a href="javascript:expandOrCollapse('note_1_1', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_1_1" border="0"/></a></td><td>Definitive</td><td>Authentication.Entity</td><td><img src="resource/images/yellow-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\util\DBUtil.java</td><td align="right">73</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/257.html">257</a></td><td align="center"/><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_1_1"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>			instance = new DBUtil();<br/>		<br/>		if (instance.connection == null || instance.connection.isClosed()){<br/>			try {<br/>				//attempt to connect to the database<br/><font class="vuln_code">				instance.connection = DriverManager.getConnection(PROTOCOL+"altoro");</font><br/>			} catch (SQLException e){<br/>				//if database does not exist, create it an initialize it<br/>				if (e.getErrorCode() == 40000){<br/>					instance.initDB();<br/>				//otherwise pass along the exception<br/></pre></td></tr></tbody></table></div></td></tr><tr><td><a href="javascript:expandOrCollapse('note_1_2', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_1_2" border="0"/></a></td><td>Definitive</td><td>Authentication.Entity</td><td><img src="resource/images/yellow-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\util\DBUtil.java</td><td align="right">92</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/257.html">257</a></td><td align="center"/><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_1_2"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>	/*<br/>	 * Create and initialize the database<br/>	 */<br/>	private void initDB() throws SQLException{<br/>		<br/><font class="vuln_code">		connection = DriverManager.getConnection(PROTOCOL+"altoro;create=true");</font><br/>		Statement statement = connection.createStatement();<br/>		<br/>//		statement.execute("DROP TABLE PEOPLE");<br/>//		statement.execute("DROP TABLE ACCOUNTS");<br/>//		statement.execute("DROP TABLE TRANSACTIONS");<br/></pre></td></tr></tbody></table></div></td></tr></tbody></table><div class="findingHeader">Common API Call: CrossSiteScripting</div><div class="fixGroupDivergenceAPI">javax.servlet.jsp.JspWriter.print(java.lang.Object):void</div><table width="100%"><tbody><tr vAlign="middle" align="left" bgColor="#444444"><th bgColor="white" width="1"/><th class="VulnTableHeader" width="40">Classification</th><th class="VulnTableHeader" width="40">Type</th><th class="VulnTableHeader" width="50">Severity</th><th class="VulnTableHeader" width="300">File</th><th class="VulnTableHeader" width="40" align="right">Line</th><th class="VulnTableHeader" width="75" align="right">CWE ID</th><th class="VulnTableHeader" width="75">Trace</th><th class="VulnTableHeader" width="75">Notes</th></tr><tr><td><a href="javascript:expandOrCollapse('note_2_1', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_2_1" border="0"/></a></td><td>Definitive</td><td>CrossSiteScripting</td><td><img src="resource/images/yellow-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\subscribe.jsp</td><td align="right">20</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/79.html">79</a></td><td align="center"><a href="javascript:expandOrCollapse('note_2_1', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_2_1"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>			<br/>			&lt;form action="doSubscribe" method="post" name="subscribe" id="subscribe" onsubmit="return confirmEmail(txtEmail.value);"&gt;<br/>			  &lt;table&gt;<br/>			    &lt;tr&gt;<br/>			      &lt;td colspan="2"&gt;<br/><font class="vuln_code">			        &lt;div style="font-weight: bold; font-size: 12px; color: red;" id="message"&gt;&lt;%=(request.getAttribute("message_subscribe"</font><br/><font class="vuln_code">!=null)?request.getAttribute("message_subscribe"):"" %&gt;&lt;/div&gt;</font><br/>			      &lt;/td&gt;<br/>			    &lt;/tr&gt;<br/>			    &lt;tr&gt;<br/>			      &lt;td&gt;<br/>			        Email:<br/></pre></td></tr></tbody></table></div></td></tr><tr><td><a href="javascript:expandOrCollapse('note_2_2', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_2_2" border="0"/></a></td><td>Definitive</td><td>CrossSiteScripting</td><td><img src="resource/images/yellow-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\bank\transfer.jsp</td><td align="right">82</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/79.html">79</a></td><td align="center"><a href="javascript:expandOrCollapse('note_2_2', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_2_2"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>		  &lt;tr&gt;<br/>		    &lt;td colspan="2"&gt;&amp;nbsp;&lt;/td&gt;<br/>		  &lt;/tr&gt;<br/>		  &lt;tr&gt;<br/>		    &lt;td colspan="2" align="center"&gt;<br/><font class="vuln_code">		    &lt;span id="_ctl0__ctl0_Content_Main_postResp" align="center"&gt;&lt;span style='color: Red'&gt;&lt;%=(request.getAttribute("message")==n</font><br/><font class="vuln_code">ll)?"":request.getAttribute("message") %&gt;&lt;/span&gt;&lt;/span&gt;</font><br/>		    &lt;span id="soapResp" name="soapResp" align="center" /&gt;<br/>		    &lt;/td&gt;<br/>		  &lt;/tr&gt;<br/>		&lt;/table&gt;<br/>		&lt;/form&gt;<br/></pre></td></tr></tbody></table></div></td></tr></tbody></table><div class="fixGroupDivergenceAPI">javax.servlet.jsp.JspWriter.print(java.lang.String):void</div><table width="100%"><tbody><tr vAlign="middle" align="left" bgColor="#444444"><th bgColor="white" width="1"/><th class="VulnTableHeader" width="40">Classification</th><th class="VulnTableHeader" width="40">Type</th><th class="VulnTableHeader" width="50">Severity</th><th class="VulnTableHeader" width="300">File</th><th class="VulnTableHeader" width="40" align="right">Line</th><th class="VulnTableHeader" width="75" align="right">CWE ID</th><th class="VulnTableHeader" width="75">Trace</th><th class="VulnTableHeader" width="75">Notes</th></tr><tr><td><a href="javascript:expandOrCollapse('note_2_1', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_2_1" border="0"/></a></td><td>Definitive</td><td>CrossSiteScripting</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\admin\admin.jsp</td><td align="right">42</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/79.html">79</a></td><td align="center"><a href="javascript:expandOrCollapse('note_2_1', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_2_1"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>		&lt;p&gt;&lt;span style="color:#FF0066;font-size:12pt;font-weight:bold;"&gt;<br/>		&lt;%<br/>		java.lang.String error = (String)request.getSession().getAttribute("message");<br/>		<br/>		if (error != null &amp;&amp; error.trim().length() &gt; 0){<br/><font class="vuln_code">			out.print(error);</font><br/>		}<br/>		%&gt;<br/>		&lt;/span&gt;&lt;/p&gt;<br/>		<br/>		&lt;h1&gt;Edit User Information&lt;/h1&gt;<br/></pre></td></tr></tbody></table></div></td></tr><tr><td><a href="javascript:expandOrCollapse('note_2_2', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_2_2" border="0"/></a></td><td>Definitive</td><td>CrossSiteScripting</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\bank\balance.jsp</td><td align="right">37</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/79.html">79</a></td><td align="center"><a href="javascript:expandOrCollapse('note_2_2', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_2_2"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>				%&gt;<br/>		<br/>		&lt;!-- To modify account information do not connect to SQL source directly.  Make all changes<br/>		through the admin page. --&gt;<br/>		<br/><font class="vuln_code">		&lt;h1&gt;Account History - &lt;%=accountName%&gt;&lt;/h1&gt;</font><br/>		<br/>		&lt;table width="590" border="0"&gt;<br/>		  &lt;tr&gt;<br/>		    &lt;td colspan=2&gt;<br/>		      &lt;table cellSpacing="0" cellPadding="1" width="100%" border="1"&gt;<br/></pre></td></tr></tbody></table></div></td></tr><tr><td><a href="javascript:expandOrCollapse('note_2_3', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_2_3" border="0"/></a></td><td>Definitive</td><td>CrossSiteScripting</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\bank\customize.jsp</td><td align="right">15</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/79.html">79</a></td><td align="center"><a href="javascript:expandOrCollapse('note_2_3', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_2_3"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>		<br/>		&lt;h1&gt;Customize Site Language&lt;/h1&gt;<br/>		<br/>		&lt;form method="post"&gt;<br/>		  &lt;p&gt;<br/><font class="vuln_code">		  Curent Language: &lt;%=(request.getParameter("lang")==null)?"":request.getParameter("lang")%&gt;</font><br/>		  &lt;/p&gt;<br/>		<br/>		  &lt;p&gt;<br/>		  You can change the language setting by choosing:<br/>		  &lt;/p&gt;<br/></pre></td></tr></tbody></table></div></td></tr><tr><td><a href="javascript:expandOrCollapse('note_2_4', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_2_4" border="0"/></a></td><td>Definitive</td><td>CrossSiteScripting</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\feedbacksuccess.jsp</td><td align="right">20</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/79.html">79</a></td><td align="center"><a href="javascript:expandOrCollapse('note_2_4', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_2_4"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>		<br/>		&lt;div class="fl" style="width: 99%;"&gt;<br/>		<br/>		 &lt;h1&gt;Thank You&lt;/h1&gt;<br/>		 <br/><font class="vuln_code">		 &lt;p&gt;Thank you for your comments&lt;%= (request.getAttribute("message_feedback")!=null)?", "+request.getAttribute("message_feedback</font><br/><font class="vuln_code">):"" %&gt;.  They will be reviewed by our Customer Service staff and given the full attention that they deserve. </font><br/>		 &lt;% String email = (String) request.getParameter("email_addr"); <br/>		 	boolean regExMatch = email!=null &amp;&amp; email.matches(ServletUtil.EMAIL_REGEXP);<br/>		 	if (email != null &amp;&amp; email.trim().length() != 0 &amp;&amp; regExMatch) {%&gt; <br/>			 Our reply will be sent to your email: &lt;%= ServletUtil.sanitizeBasic(email.toLowerCase()) /*email.toLowerCase()*/ %&gt;<br/>		&lt;% } else {%&gt;<br/></pre></td></tr></tbody></table></div></td></tr><tr><td><a href="javascript:expandOrCollapse('note_2_5', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_2_5" border="0"/></a></td><td>Definitive</td><td>CrossSiteScripting</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\feedbacksuccess.jsp</td><td align="right">24</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/79.html">79</a></td><td align="center"><a href="javascript:expandOrCollapse('note_2_5', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_2_5"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>		 <br/>		 &lt;p&gt;Thank you for your comments&lt;%= (request.getAttribute("message_feedback")!=null)?", "+request.getAttribute("message_feedback<br/>):"" %&gt;.  They will be reviewed by our Customer Service staff and given the full attention that they deserve. <br/>		 &lt;% String email = (String) request.getParameter("email_addr"); <br/>		 	boolean regExMatch = email!=null &amp;&amp; email.matches(ServletUtil.EMAIL_REGEXP);<br/>		 	if (email != null &amp;&amp; email.trim().length() != 0 &amp;&amp; regExMatch) {%&gt; <br/><font class="vuln_code">			 Our reply will be sent to your email: &lt;%= ServletUtil.sanitizeBasic(email.toLowerCase()) /*email.toLowerCase()*/ %&gt;</font><br/>		&lt;% } else {%&gt;<br/>			However, the email you gave is incorrect (&lt;%=email.toLowerCase() /*ServletUtil.sanitizeWeb(email.toLowerCase())*/%&gt;) and you w<br/>ll not receive a response.<br/>		&lt;% }%&gt;<br/>		<br/>		&lt;/p&gt;<br/></pre></td></tr></tbody></table></div></td></tr><tr><td><a href="javascript:expandOrCollapse('note_2_6', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_2_6" border="0"/></a></td><td>Definitive</td><td>CrossSiteScripting</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\feedbacksuccess.jsp</td><td align="right">26</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/79.html">79</a></td><td align="center"><a href="javascript:expandOrCollapse('note_2_6', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_2_6"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>		 &lt;% String email = (String) request.getParameter("email_addr"); <br/>		 	boolean regExMatch = email!=null &amp;&amp; email.matches(ServletUtil.EMAIL_REGEXP);<br/>		 	if (email != null &amp;&amp; email.trim().length() != 0 &amp;&amp; regExMatch) {%&gt; <br/>			 Our reply will be sent to your email: &lt;%= ServletUtil.sanitizeBasic(email.toLowerCase()) /*email.toLowerCase()*/ %&gt;<br/>		&lt;% } else {%&gt;<br/><font class="vuln_code">			However, the email you gave is incorrect (&lt;%=email.toLowerCase() /*ServletUtil.sanitizeWeb(email.toLowerCase())*/%&gt;) and you w</font><br/><font class="vuln_code">ll not receive a response.</font><br/>		&lt;% }%&gt;<br/>		<br/>		&lt;/p&gt;<br/>		<br/>		&lt;/div&gt;<br/></pre></td></tr></tbody></table></div></td></tr><tr><td><a href="javascript:expandOrCollapse('note_2_7', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_2_7" border="0"/></a></td><td>Definitive</td><td>CrossSiteScripting</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\admin\login.jsp</td><td align="right">20</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/79.html">79</a></td><td align="center"><a href="javascript:expandOrCollapse('note_2_7', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_2_7"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>		  &lt;p&gt;<br/>		&lt;!--  add captcha input here --&gt;<br/>		    &lt;strong&gt;Enter the administrative password:&lt;/strong&gt;&lt;br /&gt;<br/>		    &lt;input id="password" name="password" type=password runat="server" /&gt;&lt;br /&gt;&lt;br /&gt;<br/>		    &lt;input type="submit" name="btnSubmit" value="Login"&gt;<br/><font class="vuln_code">		  &lt;/p&gt;</font><br/>		&lt;p&gt;&lt;span id="_ctl0__ctl0_Content_Main_message" style="color:#FF0066;font-size:12pt;font-weight:bold;"&gt;<br/>			&lt;%<br/>			java.lang.String error = (String)request.getAttribute("loginError");<br/>			<br/>			if (error != null &amp;&amp; error.trim().length() &gt; 0){<br/></pre></td></tr></tbody></table></div></td></tr><tr><td><a href="javascript:expandOrCollapse('note_2_8', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_2_8" border="0"/></a></td><td>Definitive</td><td>CrossSiteScripting</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\admin\login.jsp</td><td align="right">27</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/79.html">79</a></td><td align="center"><a href="javascript:expandOrCollapse('note_2_8', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_2_8"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>			&lt;%<br/>			java.lang.String error = (String)request.getAttribute("loginError");<br/>			<br/>			if (error != null &amp;&amp; error.trim().length() &gt; 0){<br/>				request.getSession().removeAttribute("loginError");<br/><font class="vuln_code">				out.print(error);</font><br/>			}<br/>			%&gt;<br/>		&lt;/span&gt;&lt;/p&gt;<br/>		&lt;/form&gt;<br/>		<br/></pre></td></tr></tbody></table></div></td></tr><tr><td><a href="javascript:expandOrCollapse('note_2_9', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_2_9" border="0"/></a></td><td>Definitive</td><td>CrossSiteScripting</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\bank\queryxpath.jsp</td><td align="right">16</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/79.html">79</a></td><td align="center"><a href="javascript:expandOrCollapse('note_2_9', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_2_9"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>			&lt;h1&gt;Search News Articles&lt;/h1&gt;<br/>			&lt;form id="QueryXpath" method="get" action="&lt;%=request.getRequestURL()%&gt;"&gt;<br/>			  Search our news articles database<br/>			  &lt;br /&gt;&lt;br /&gt;<br/>				&lt;input type="hidden" id=content" name="content" value="queryxpath.jsp"/&gt;<br/><font class="vuln_code">				&lt;input type="text" id="query" name="query" width=450 value="&lt;%=(request.getParameter("query")==null)?"Enter title (e.g. Watch</font><br/><font class="vuln_code">ire)":request.getParameter("query")%&gt;"/&gt;</font><br/>				&lt;input type="submit" width=75 id="Button1" value="Query"&gt;<br/>			  &lt;br /&gt;&lt;br /&gt;<br/>			&lt;%<br/>				if (request.getParameter("query") != null) {<br/>				String[] results = ServletUtil.searchArticles(request.getParameter("query"), request.getSession().getServletContext().getReal<br/>ath("/pr/Docs.xml"));<br/></pre></td></tr></tbody></table></div></td></tr><tr><td><a href="javascript:expandOrCollapse('note_2_10', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_2_10" border="0"/></a></td><td>Definitive</td><td>CrossSiteScripting</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\search.jsp</td><td align="right">24</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/79.html">79</a></td><td align="center"><a href="javascript:expandOrCollapse('note_2_10', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_2_10"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>		<br/>		&lt;h1&gt;Search Results&lt;/h1&gt;<br/>		<br/>		&lt;p&gt;No results were found for the query:&lt;br /&gt;&lt;br /&gt;<br/>		<br/><font class="vuln_code">		&lt;%= query %&gt;</font><br/>		<br/>		&lt;/div&gt;    <br/>    &lt;/td&gt;	<br/>&lt;/div&gt;<br/><br/></pre></td></tr></tbody></table></div></td></tr><tr><td><a href="javascript:expandOrCollapse('note_2_11', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_2_11" border="0"/></a></td><td>Definitive</td><td>CrossSiteScripting</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\util\serverStatusCheckService.jsp</td><td align="right">4</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/79.html">79</a></td><td align="center"><a href="javascript:expandOrCollapse('note_2_11', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_2_11"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>&lt;%@ page language="java" contentType="text/html; charset=ISO-8859-1" pageEncoding="ISO-8859-1"%&gt;<br/><br/>{<br/><font class="vuln_code">	"HostName": "&lt;%=request.getParameter("HostName")%&gt;",</font><br/>	"HostStatus": "OK"<br/>}<br/></pre></td></tr></tbody></table></div></td></tr><tr><td><a href="javascript:expandOrCollapse('note_2_12', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_2_12" border="0"/></a></td><td>Definitive</td><td>CrossSiteScripting</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\bank\transaction.jsp</td><td align="right">95</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/79.html">79</a></td><td align="center"><a href="javascript:expandOrCollapse('note_2_12', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_2_12"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>		&lt;font style="bold" color="red"&gt;&lt;%=error%&gt;&lt;/font&gt;<br/>		&lt;form id="Form1" name="Form1" method="post" action="showTransactions" onsubmit="return (confirminput(Form1));"&gt;<br/>		&lt;table border="0" style="padding-bottom:10px;"&gt;<br/>		    &lt;tr&gt;<br/>		        &lt;td valign=top&gt;After&lt;/td&gt;<br/><font class="vuln_code">		        &lt;td&gt;&lt;input id="startDate" name="startDate" type="text" value="&lt;%=(request.getParameter("startDate")==null)?"":request.g</font><br/><font class="vuln_code">tParameter("startDate")%&gt;"/&gt;&lt;br /&gt;&lt;span class="credit"&gt;yyyy-mm-dd&lt;/span&gt;&lt;/td&gt;</font><br/>		        &lt;td valign=top&gt;Before&lt;/td&gt;<br/>		        &lt;td&gt;&lt;input name="endDate" id="endDate" type="text" value="&lt;%=(request.getParameter("endDate")==null)?"":request.getPara<br/>eter("endDate") %&gt;"/&gt;&lt;br /&gt;&lt;span class="credit"&gt;yyyy-mm-dd&lt;/span&gt;&lt;/td&gt;<br/>		        &lt;td valign=top&gt;&lt;input type=submit value=Submit /&gt;&lt;/td&gt;<br/>		    &lt;/tr&gt;<br/>		&lt;/table&gt;<br/></pre></td></tr></tbody></table></div></td></tr><tr><td><a href="javascript:expandOrCollapse('note_2_13', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_2_13" border="0"/></a></td><td>Definitive</td><td>CrossSiteScripting</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\bank\transaction.jsp</td><td align="right">97</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/79.html">79</a></td><td align="center"><a href="javascript:expandOrCollapse('note_2_13', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_2_13"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>		&lt;table border="0" style="padding-bottom:10px;"&gt;<br/>		    &lt;tr&gt;<br/>		        &lt;td valign=top&gt;After&lt;/td&gt;<br/>		        &lt;td&gt;&lt;input id="startDate" name="startDate" type="text" value="&lt;%=(request.getParameter("startDate")==null)?"":request.g<br/>tParameter("startDate")%&gt;"/&gt;&lt;br /&gt;&lt;span class="credit"&gt;yyyy-mm-dd&lt;/span&gt;&lt;/td&gt;<br/>		        &lt;td valign=top&gt;Before&lt;/td&gt;<br/><font class="vuln_code">		        &lt;td&gt;&lt;input name="endDate" id="endDate" type="text" value="&lt;%=(request.getParameter("endDate")==null)?"":request.getPara</font><br/><font class="vuln_code">eter("endDate") %&gt;"/&gt;&lt;br /&gt;&lt;span class="credit"&gt;yyyy-mm-dd&lt;/span&gt;&lt;/td&gt;</font><br/>		        &lt;td valign=top&gt;&lt;input type=submit value=Submit /&gt;&lt;/td&gt;<br/>		    &lt;/tr&gt;<br/>		&lt;/table&gt;<br/>		<br/>		&lt;table cellspacing="0" cellpadding="3" rules="all" border="1" id="_ctl0__ctl0_Content_Main_MyTransactions" style="width:100%;bo<br/>der-collapse:collapse;"&gt;<br/></pre></td></tr></tbody></table></div></td></tr><tr><td><a href="javascript:expandOrCollapse('note_2_14', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_2_14" border="0"/></a></td><td>Suspect</td><td>CrossSiteScripting</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\feedback.jsp</td><td align="right">39</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/79.html">79</a></td><td align="center"><a href="javascript:expandOrCollapse('note_2_14', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_2_14"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>		    &lt;td align=right&gt;To:&lt;/td&gt;<br/>		    &lt;td valign=top&gt;&lt;b&gt;Online Banking&lt;/b&gt; &lt;/td&gt;<br/>		  &lt;/tr&gt;<br/>		  &lt;tr&gt;<br/>		    &lt;td align=right&gt;Your Name:&lt;/td&gt;<br/><font class="vuln_code">		    &lt;td valign=top&gt;&lt;input name="name" size=25 type=text value = "&lt;%= ((user != null &amp;&amp; user.getFirstName() != null)?user.getFir</font><br/><font class="vuln_code">tName()+" ":"") + ((user != null &amp;&amp; user.getLastName() != null)?user.getLastName():"") %&gt;"&gt;&lt;/td&gt;</font><br/>		  &lt;/tr&gt;<br/>		  &lt;tr&gt;<br/>		    &lt;td align=right&gt;Your Email Address:&lt;/td&gt;<br/>		    &lt;td valign=top&gt;&lt;input name="email_addr" type=text size=25&gt;&lt;/td&gt;<br/>		  &lt;/tr&gt;<br/></pre></td></tr><tr><td class="trace"><table cellpadding="0" cellspacing="0"><thead><tr><th class="traceheader" align="left">Method</th><th class="traceheader" align="left">File</th><th class="traceheader" align="right" width="75">Line</th><th class="traceheader" align="right" width="85">Tainted Arg</th></tr></thead><tbody><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td/><td><img src="resource/images/method.gif"/></td><td>&nbsp;org.apache.jsp.feedback_jsp._jspService&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\feedback.jsp</td><td align="right">13</td><td align="right"/></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_middle.gif"/></td><td><img src="resource/images/iotsource.gif"/></td><td>&nbsp;javax.servlet.http.HttpSession.getAttribute&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\feedback.jsp</td><td align="right">13</td><td align="right">return val</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_middle.gif"/></td><td><img src="resource/images/method.gif"/></td><td>&nbsp;com.ibm.security.appscan.altoromutual.model.User.getLastName&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\feedback.jsp</td><td align="right">39</td><td align="right">user</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_middle.gif"/></td><td><img src="resource/images/methodNotValidator.gif"/></td><td>&nbsp;java.lang.StringBuilder.append&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\feedback.jsp</td><td align="right">39</td><td align="right">Temp#20@0</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_middle.gif"/></td><td><img src="resource/images/methodNotValidator.gif"/></td><td>&nbsp;java.lang.StringBuilder.toString&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\feedback.jsp</td><td align="right">39</td><td align="right">Temp#19@0 </td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_bottom.gif"/></td><td><img src="resource/images/methodTraceSink.gif"/></td><td>&nbsp;javax.servlet.jsp.JspWriter.print&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\feedback.jsp</td><td align="right">39</td><td align="right">Temp#19@0 </td></tr></tbody></table></td></tr></tbody></table></div></td></tr></tbody></table><div class="findingHeader">Common API Call: Injection.SQL</div><div class="fixGroupDivergenceAPI">java.sql.Statement.executeQuery(java.lang.String):java.sql.ResultSet</div><table width="100%"><tbody><tr vAlign="middle" align="left" bgColor="#444444"><th bgColor="white" width="1"/><th class="VulnTableHeader" width="40">Classification</th><th class="VulnTableHeader" width="40">Type</th><th class="VulnTableHeader" width="50">Severity</th><th class="VulnTableHeader" width="300">File</th><th class="VulnTableHeader" width="40" align="right">Line</th><th class="VulnTableHeader" width="75" align="right">CWE ID</th><th class="VulnTableHeader" width="75">Trace</th><th class="VulnTableHeader" width="75">Notes</th></tr><tr><td><a href="javascript:expandOrCollapse('note_3_1', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_3_1" border="0"/></a></td><td>Definitive</td><td>Injection.SQL</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\util\DBUtil.java</td><td align="right">146</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/89.html">89</a></td><td align="center"><a href="javascript:expandOrCollapse('note_3_1', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_3_1"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>		if (username == null || username.trim().length() == 0)<br/>			return null; <br/>		<br/>		Connection connection = getConnection();<br/>		Statement statement = connection.createStatement();<br/><font class="vuln_code">		ResultSet resultSet =statement.executeQuery("SELECT FIRST_NAME,LAST_NAME,ROLE FROM PEOPLE WHERE USER_ID = '"+ username +"' "); </font><br/><font class="vuln_code">* BAD - user input should always be sanitized */</font><br/><br/>		String firstName = null;<br/>		String lastName = null;<br/>		String roleString = null;<br/>		if (resultSet.next()){<br/></pre></td></tr></tbody></table></div></td></tr></tbody></table><div class="findingHeader">Common API Call: Validation.EncodingRequired</div><div class="fixGroupDivergenceAPI">java.io.PrintWriter.write(java.lang.String):void</div><table width="100%"><tbody><tr vAlign="middle" align="left" bgColor="#444444"><th bgColor="white" width="1"/><th class="VulnTableHeader" width="40">Classification</th><th class="VulnTableHeader" width="40">Type</th><th class="VulnTableHeader" width="50">Severity</th><th class="VulnTableHeader" width="300">File</th><th class="VulnTableHeader" width="40" align="right">Line</th><th class="VulnTableHeader" width="75" align="right">CWE ID</th><th class="VulnTableHeader" width="75">Trace</th><th class="VulnTableHeader" width="75">Notes</th></tr><tr><td><a href="javascript:expandOrCollapse('note_4_1', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_4_1" border="0"/></a></td><td>Definitive</td><td>Validation.EncodingRequired</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\servlet\SurveyServlet.java</td><td align="right">92</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/116.html">116</a></td><td align="center"><a href="javascript:expandOrCollapse('note_4_1', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_4_1"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>			"&lt;div width=\"99%\"&gt;&lt;p&gt;It appears that you attempted to skip or repeat some areas of this survey.  Please &lt;a href=\"survey_que<br/>tions.jsp\"&gt;return to the start page&lt;/a&gt; to begin again.&lt;/p&gt;&lt;/div&gt;";<br/>		} else {		<br/>			request.getSession().setAttribute("surveyStep", step);<br/>		}<br/>		response.setContentType("text/html");<br/><font class="vuln_code">		response.getWriter().write(content);</font><br/>		response.getWriter().flush();<br/>		<br/>	}<br/>}<br/></pre></td></tr></tbody></table></div></td></tr></tbody></table><div class="findingHeader">Common API Call: Validation.Required</div><div class="fixGroupDivergenceAPI">javax.servlet.http.HttpSession.setAttribute(java.lang.String;java.lang.Object):void</div><table width="100%"><tbody><tr vAlign="middle" align="left" bgColor="#444444"><th bgColor="white" width="1"/><th class="VulnTableHeader" width="40">Classification</th><th class="VulnTableHeader" width="40">Type</th><th class="VulnTableHeader" width="50">Severity</th><th class="VulnTableHeader" width="300">File</th><th class="VulnTableHeader" width="40" align="right">Line</th><th class="VulnTableHeader" width="75" align="right">CWE ID</th><th class="VulnTableHeader" width="75">Trace</th><th class="VulnTableHeader" width="75">Notes</th></tr><tr><td><a href="javascript:expandOrCollapse('note_5_1', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_5_1" border="0"/></a></td><td>Definitive</td><td>Validation.Required</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\servlet\SurveyServlet.java</td><td align="right">89</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/20.html">20</a></td><td align="center"><a href="javascript:expandOrCollapse('note_5_1', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_5_1"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>										request.getSession().getAttribute("surveyStep") == null ||<br/>										!request.getSession().getAttribute("surveyStep").equals(previousStep))){<br/>			content = "&lt;h1&gt;Request Out of Order&lt;/h1&gt;"+<br/>			"&lt;div width=\"99%\"&gt;&lt;p&gt;It appears that you attempted to skip or repeat some areas of this survey.  Please &lt;a href=\"survey_que<br/>tions.jsp\"&gt;return to the start page&lt;/a&gt; to begin again.&lt;/p&gt;&lt;/div&gt;";<br/>		} else {		<br/><font class="vuln_code">			request.getSession().setAttribute("surveyStep", step);</font><br/>		}<br/>		response.setContentType("text/html");<br/>		response.getWriter().write(content);<br/>		response.getWriter().flush();<br/>		<br/></pre></td></tr></tbody></table></div></td></tr></tbody></table><div class="fixGroupDivergenceAPI">javax.servlet.ServletRequest.setAttribute(java.lang.String;java.lang.Object):void</div><table width="100%"><tbody><tr vAlign="middle" align="left" bgColor="#444444"><th bgColor="white" width="1"/><th class="VulnTableHeader" width="40">Classification</th><th class="VulnTableHeader" width="40">Type</th><th class="VulnTableHeader" width="50">Severity</th><th class="VulnTableHeader" width="300">File</th><th class="VulnTableHeader" width="40" align="right">Line</th><th class="VulnTableHeader" width="75" align="right">CWE ID</th><th class="VulnTableHeader" width="75">Trace</th><th class="VulnTableHeader" width="75">Notes</th></tr><tr><td><a href="javascript:expandOrCollapse('note_5_1', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_5_1" border="0"/></a></td><td>Definitive</td><td>Validation.Required</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\servlet\FeedbackServlet.java</td><td align="right">40</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/20.html">20</a></td><td align="center"><a href="javascript:expandOrCollapse('note_5_1', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_5_1"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>			return;<br/>		}<br/><br/>		String name = request.getParameter("name");<br/>		if (name != null){<br/><font class="vuln_code">			request.setAttribute("message_feedback", name);</font><br/>		} else {<br/>			request.removeAttribute("name");<br/>		}<br/>		<br/>		RequestDispatcher dispatcher = request.getRequestDispatcher("/feedbacksuccess.jsp");<br/></pre></td></tr></tbody></table></div></td></tr><tr><td><a href="javascript:expandOrCollapse('note_5_2', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_5_2" border="0"/></a></td><td>Definitive</td><td>Validation.Required</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\servlet\SubscribeServlet.java</td><td align="right">41</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/20.html">20</a></td><td align="center"><a href="javascript:expandOrCollapse('note_5_2', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_5_2"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>			response.sendRedirect("index.jsp");<br/>			return;<br/>		}<br/>		<br/>		//don't actually subscribe the user<br/><font class="vuln_code">		request.setAttribute("message_subscribe", "Thank you. Your email " + email + " has been accepted.");</font><br/>		RequestDispatcher dispatcher = request.getRequestDispatcher("subscribe.jsp");<br/>		dispatcher.forward(request, response);<br/>	}<br/><br/>}<br/></pre></td></tr></tbody></table></div></td></tr></tbody></table><div class="findingHeader">Common Fix Point: CrossSiteScripting</div><div class="fixGroupDivergenceAPI">com.ibm.security.appscan.altoromutual.util.DBUtil.getBankUsernames():java.lang.String[]</div><table width="100%"><tbody><tr vAlign="middle" align="left" bgColor="#444444"><th bgColor="white" width="1"/><th class="VulnTableHeader" width="40">Classification</th><th class="VulnTableHeader" width="40">Type</th><th class="VulnTableHeader" width="50">Severity</th><th class="VulnTableHeader" width="300">File</th><th class="VulnTableHeader" width="40" align="right">Line</th><th class="VulnTableHeader" width="75" align="right">CWE ID</th><th class="VulnTableHeader" width="75">Trace</th><th class="VulnTableHeader" width="75">Notes</th></tr><tr><td><a href="javascript:expandOrCollapse('note_6_1', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_6_1" border="0"/></a></td><td>Definitive</td><td>CrossSiteScripting</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\admin\admin.jsp</td><td align="right">71</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/79.html">79</a></td><td align="center"><a href="javascript:expandOrCollapse('note_6_1', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_6_1"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>		  &lt;/tr&gt;<br/>		  &lt;tr&gt;<br/>		    &lt;td&gt;<br/>		      	&lt;select name="username" id="username" size="1"&gt;<br/>					&lt;% for (String user:users){ %&gt;<br/><font class="vuln_code">					&lt;option value="&lt;%=user%&gt;"&gt;&lt;%=user%&gt;&lt;/option&gt;</font><br/>					&lt;%} %&gt;<br/>				&lt;/select&gt;<br/>		    &lt;/td&gt;<br/>		    &lt;td&gt;<br/>		      &lt;Select name="accttypes"&gt;<br/></pre></td></tr></tbody></table></div></td></tr><tr><td><a href="javascript:expandOrCollapse('note_6_2', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_6_2" border="0"/></a></td><td>Definitive</td><td>CrossSiteScripting</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\admin\admin.jsp</td><td align="right">107</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/79.html">79</a></td><td align="center"><a href="javascript:expandOrCollapse('note_6_2', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_6_2"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>		  &lt;/tr&gt;<br/>		  &lt;tr&gt;<br/>		    &lt;td&gt;<br/>		        &lt;select name="username" id="username" size="1"&gt;<br/>					&lt;% for (String user:users){ %&gt;<br/><font class="vuln_code">					&lt;option value="&lt;%=user%&gt;"&gt;&lt;%=user%&gt;&lt;/option&gt;</font><br/>					&lt;%} %&gt;<br/>				&lt;/select&gt;<br/>		    &lt;/td&gt;<br/>		    &lt;td&gt;<br/>		      &lt;input type="password" name="password1"&gt;<br/></pre></td></tr></tbody></table></div></td></tr><tr><td><a href="javascript:expandOrCollapse('note_6_3', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_6_3" border="0"/></a></td><td>Suspect</td><td>CrossSiteScripting</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\admin\admin.jsp</td><td align="right">71</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/79.html">79</a></td><td align="center"><a href="javascript:expandOrCollapse('note_6_3', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_6_3"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>		  &lt;/tr&gt;<br/>		  &lt;tr&gt;<br/>		    &lt;td&gt;<br/>		      	&lt;select name="username" id="username" size="1"&gt;<br/>					&lt;% for (String user:users){ %&gt;<br/><font class="vuln_code">					&lt;option value="&lt;%=user%&gt;"&gt;&lt;%=user%&gt;&lt;/option&gt;</font><br/>					&lt;%} %&gt;<br/>				&lt;/select&gt;<br/>		    &lt;/td&gt;<br/>		    &lt;td&gt;<br/>		      &lt;Select name="accttypes"&gt;<br/></pre></td></tr><tr><td class="trace"><table cellpadding="0" cellspacing="0"><thead><tr><th class="traceheader" align="left">Method</th><th class="traceheader" align="left">File</th><th class="traceheader" align="right" width="75">Line</th><th class="traceheader" align="right" width="85">Tainted Arg</th></tr></thead><tbody><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td/><td><img src="resource/images/method.gif"/></td><td>&nbsp;org.apache.jsp.admin.admin_jsp._jspService&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\admin\admin.jsp</td><td align="right">12</td><td align="right"/></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_middle.gif"/></td><td><img src="resource/images/method.gif"/></td><td>&nbsp;com.ibm.security.appscan.altoromutual.util.ServletUtil.getBankUsers&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\admin\admin.jsp</td><td align="right">12</td><td align="right">return val</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_extender.gif"/><td><img src="resource/images/trace_tree_bottom.gif"/></td></td><td><img src="resource/images/method.gif"/></td><td>&nbsp;com.ibm.security.appscan.altoromutual.util.DBUtil.getBankUsernames&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\util\ServletUtil.java</td><td align="right">143</td><td align="right">return val</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_extender.gif"/><td><img src="resource/images/trace_tree_spacer.gif"/><td><img src="resource/images/trace_tree_middle.gif"/></td></td></td><td><img src="resource/images/iotsource.gif"/></td><td>&nbsp;java.sql.ResultSet.getString&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\util\DBUtil.java</td><td align="right">340</td><td align="right">return val</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_extender.gif"/><td><img src="resource/images/trace_tree_spacer.gif"/><td><img src="resource/images/trace_tree_middle.gif"/></td></td></td><td><img src="resource/images/methodNotValidator.gif"/></td><td>&nbsp;java.util.ArrayList.add&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\util\DBUtil.java</td><td align="right">341</td><td align="right">name</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_extender.gif"/><td><img src="resource/images/trace_tree_spacer.gif"/><td><img src="resource/images/trace_tree_bottom.gif"/></td></td></td><td><img src="resource/images/methodNotValidator.gif"/></td><td>&nbsp;java.util.ArrayList.toArray&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\util\DBUtil.java</td><td align="right">344</td><td align="right">users</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_bottom.gif"/></td><td><img src="resource/images/methodTraceSink.gif"/></td><td>&nbsp;javax.servlet.jsp.JspWriter.print&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\admin\admin.jsp</td><td align="right">71</td><td align="right">user</td></tr></tbody></table></td></tr></tbody></table></div></td></tr><tr><td><a href="javascript:expandOrCollapse('note_6_4', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_6_4" border="0"/></a></td><td>Suspect</td><td>CrossSiteScripting</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\admin\admin.jsp</td><td align="right">107</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/79.html">79</a></td><td align="center"><a href="javascript:expandOrCollapse('note_6_4', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_6_4"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>		  &lt;/tr&gt;<br/>		  &lt;tr&gt;<br/>		    &lt;td&gt;<br/>		        &lt;select name="username" id="username" size="1"&gt;<br/>					&lt;% for (String user:users){ %&gt;<br/><font class="vuln_code">					&lt;option value="&lt;%=user%&gt;"&gt;&lt;%=user%&gt;&lt;/option&gt;</font><br/>					&lt;%} %&gt;<br/>				&lt;/select&gt;<br/>		    &lt;/td&gt;<br/>		    &lt;td&gt;<br/>		      &lt;input type="password" name="password1"&gt;<br/></pre></td></tr><tr><td class="trace"><table cellpadding="0" cellspacing="0"><thead><tr><th class="traceheader" align="left">Method</th><th class="traceheader" align="left">File</th><th class="traceheader" align="right" width="75">Line</th><th class="traceheader" align="right" width="85">Tainted Arg</th></tr></thead><tbody><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td/><td><img src="resource/images/method.gif"/></td><td>&nbsp;org.apache.jsp.admin.admin_jsp._jspService&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\admin\admin.jsp</td><td align="right">12</td><td align="right"/></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_middle.gif"/></td><td><img src="resource/images/method.gif"/></td><td>&nbsp;com.ibm.security.appscan.altoromutual.util.ServletUtil.getBankUsers&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\admin\admin.jsp</td><td align="right">12</td><td align="right">return val</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_extender.gif"/><td><img src="resource/images/trace_tree_bottom.gif"/></td></td><td><img src="resource/images/method.gif"/></td><td>&nbsp;com.ibm.security.appscan.altoromutual.util.DBUtil.getBankUsernames&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\util\ServletUtil.java</td><td align="right">143</td><td align="right">return val</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_extender.gif"/><td><img src="resource/images/trace_tree_spacer.gif"/><td><img src="resource/images/trace_tree_middle.gif"/></td></td></td><td><img src="resource/images/iotsource.gif"/></td><td>&nbsp;java.sql.ResultSet.getString&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\util\DBUtil.java</td><td align="right">340</td><td align="right">return val</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_extender.gif"/><td><img src="resource/images/trace_tree_spacer.gif"/><td><img src="resource/images/trace_tree_middle.gif"/></td></td></td><td><img src="resource/images/methodNotValidator.gif"/></td><td>&nbsp;java.util.ArrayList.add&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\util\DBUtil.java</td><td align="right">341</td><td align="right">name</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_extender.gif"/><td><img src="resource/images/trace_tree_spacer.gif"/><td><img src="resource/images/trace_tree_bottom.gif"/></td></td></td><td><img src="resource/images/methodNotValidator.gif"/></td><td>&nbsp;java.util.ArrayList.toArray&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\util\DBUtil.java</td><td align="right">344</td><td align="right">users</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_bottom.gif"/></td><td><img src="resource/images/methodTraceSink.gif"/></td><td>&nbsp;javax.servlet.jsp.JspWriter.print&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\admin\admin.jsp</td><td align="right">107</td><td align="right">user</td></tr></tbody></table></td></tr></tbody></table></div></td></tr></tbody></table><div class="fixGroupDivergenceAPI">javax.servlet.jsp.JspWriter.print(java.lang.String):void</div><table width="100%"><tbody><tr vAlign="middle" align="left" bgColor="#444444"><th bgColor="white" width="1"/><th class="VulnTableHeader" width="40">Classification</th><th class="VulnTableHeader" width="40">Type</th><th class="VulnTableHeader" width="50">Severity</th><th class="VulnTableHeader" width="300">File</th><th class="VulnTableHeader" width="40" align="right">Line</th><th class="VulnTableHeader" width="75" align="right">CWE ID</th><th class="VulnTableHeader" width="75">Trace</th><th class="VulnTableHeader" width="75">Notes</th></tr><tr><td><a href="javascript:expandOrCollapse('note_6_1', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_6_1" border="0"/></a></td><td>Suspect</td><td>CrossSiteScripting</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\bank\main.jsp</td><td align="right">16</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/79.html">79</a></td><td align="center"><a href="javascript:expandOrCollapse('note_6_1', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_6_1"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>		<br/>		&lt;%<br/>					com.ibm.security.appscan.altoromutual.model.User user = (com.ibm.security.appscan.altoromutual.model.User)request.getSession<br/>).getAttribute("user");<br/>				%&gt;<br/>		<br/><font class="vuln_code">		&lt;h1&gt;Hello &lt;%= user.getFirstName() + " " + user.getLastName() %&gt;</font><br/>		  &lt;/h1&gt;<br/>		<br/>		&lt;p&gt;<br/>		  Welcome to Altoro Mutual Online.<br/>		&lt;/p&gt;<br/></pre></td></tr><tr><td class="trace"><table cellpadding="0" cellspacing="0"><thead><tr><th class="traceheader" align="left">Method</th><th class="traceheader" align="left">File</th><th class="traceheader" align="right" width="75">Line</th><th class="traceheader" align="right" width="85">Tainted Arg</th></tr></thead><tbody><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td/><td><img src="resource/images/method.gif"/></td><td>&nbsp;org.apache.jsp.bank.main_jsp._jspService&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\bank\main.jsp</td><td align="right">13</td><td align="right"/></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_middle.gif"/></td><td><img src="resource/images/iotsource.gif"/></td><td>&nbsp;javax.servlet.http.HttpSession.getAttribute&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\bank\main.jsp</td><td align="right">13</td><td align="right">return val</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_middle.gif"/></td><td><img src="resource/images/method.gif"/></td><td>&nbsp;com.ibm.security.appscan.altoromutual.model.User.getLastName&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\bank\main.jsp</td><td align="right">16</td><td align="right">user</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_middle.gif"/></td><td><img src="resource/images/methodNotValidator.gif"/></td><td>&nbsp;java.lang.StringBuilder.append&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\bank\main.jsp</td><td align="right">16</td><td align="right">user . com</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_middle.gif"/></td><td><img src="resource/images/methodNotValidator.gif"/></td><td>&nbsp;java.lang.StringBuilder.toString&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\bank\main.jsp</td><td align="right">16</td><td align="right">new java.l</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_bottom.gif"/></td><td><img src="resource/images/methodTraceSink.gif"/></td><td>&nbsp;javax.servlet.jsp.JspWriter.print&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\bank\main.jsp</td><td align="right">16</td><td align="right">new java.l</td></tr></tbody></table></td></tr></tbody></table></div></td></tr><tr><td><a href="javascript:expandOrCollapse('note_6_2', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_6_2" border="0"/></a></td><td>Suspect</td><td>CrossSiteScripting</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\bank\main.jsp</td><td align="right">16</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/79.html">79</a></td><td align="center"><a href="javascript:expandOrCollapse('note_6_2', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_6_2"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>		<br/>		&lt;%<br/>					com.ibm.security.appscan.altoromutual.model.User user = (com.ibm.security.appscan.altoromutual.model.User)request.getSession<br/>).getAttribute("user");<br/>				%&gt;<br/>		<br/><font class="vuln_code">		&lt;h1&gt;Hello &lt;%= user.getFirstName() + " " + user.getLastName() %&gt;</font><br/>		  &lt;/h1&gt;<br/>		<br/>		&lt;p&gt;<br/>		  Welcome to Altoro Mutual Online.<br/>		&lt;/p&gt;<br/></pre></td></tr><tr><td class="trace"><table cellpadding="0" cellspacing="0"><thead><tr><th class="traceheader" align="left">Method</th><th class="traceheader" align="left">File</th><th class="traceheader" align="right" width="75">Line</th><th class="traceheader" align="right" width="85">Tainted Arg</th></tr></thead><tbody><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td/><td><img src="resource/images/method.gif"/></td><td>&nbsp;org.apache.jsp.bank.main_jsp._jspService&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\bank\main.jsp</td><td align="right">13</td><td align="right"/></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_middle.gif"/></td><td><img src="resource/images/iotsource.gif"/></td><td>&nbsp;javax.servlet.http.HttpSession.getAttribute&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\bank\main.jsp</td><td align="right">13</td><td align="right">return val</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_middle.gif"/></td><td><img src="resource/images/method.gif"/></td><td>&nbsp;com.ibm.security.appscan.altoromutual.model.User.getFirstName&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\bank\main.jsp</td><td align="right">16</td><td align="right">user</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_middle.gif"/></td><td><img src="resource/images/methodNotValidator.gif"/></td><td>&nbsp;java.lang.String.valueOf&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\bank\main.jsp</td><td align="right">16</td><td align="right">user . com</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_middle.gif"/></td><td><img src="resource/images/methodPropagator.gif"/></td><td>&nbsp;java.lang.StringBuilder.&lt;init&gt;&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\bank\main.jsp</td><td align="right">16</td><td align="right">java.lang.</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_middle.gif"/></td><td><img src="resource/images/methodNotValidator.gif"/></td><td>&nbsp;java.lang.StringBuilder.append&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\bank\main.jsp</td><td align="right">16</td><td align="right">new java.l</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_middle.gif"/></td><td><img src="resource/images/methodNotValidator.gif"/></td><td>&nbsp;java.lang.StringBuilder.append&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\bank\main.jsp</td><td align="right">16</td><td align="right">new java.l</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_middle.gif"/></td><td><img src="resource/images/methodNotValidator.gif"/></td><td>&nbsp;java.lang.StringBuilder.toString&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\bank\main.jsp</td><td align="right">16</td><td align="right">new java.l</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_bottom.gif"/></td><td><img src="resource/images/methodTraceSink.gif"/></td><td>&nbsp;javax.servlet.jsp.JspWriter.print&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\WebContent\bank\main.jsp</td><td align="right">16</td><td align="right">new java.l</td></tr></tbody></table></td></tr></tbody></table></div></td></tr></tbody></table><div class="findingHeader">Common Fix Point: Injection.SQL</div><div class="fixGroupDivergenceAPI">com.ibm.security.appscan.altoromutual.util.DBUtil.addAccount(java.lang.String;java.lang.String):java.lang.String</div><table width="100%"><tbody><tr vAlign="middle" align="left" bgColor="#444444"><th bgColor="white" width="1"/><th class="VulnTableHeader" width="40">Classification</th><th class="VulnTableHeader" width="40">Type</th><th class="VulnTableHeader" width="50">Severity</th><th class="VulnTableHeader" width="300">File</th><th class="VulnTableHeader" width="40" align="right">Line</th><th class="VulnTableHeader" width="75" align="right">CWE ID</th><th class="VulnTableHeader" width="75">Trace</th><th class="VulnTableHeader" width="75">Notes</th></tr><tr><td><a href="javascript:expandOrCollapse('note_7_1', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_7_1" border="0"/></a></td><td>Definitive</td><td>Injection.SQL</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\util\DBUtil.java</td><td align="right">375</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/89.html">89</a></td><td align="center"><a href="javascript:expandOrCollapse('note_7_1', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_7_1"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre><br/>	public static String addAccount(String username, String acctType) {<br/>		try {<br/>			Connection connection = getConnection();<br/>			Statement statement = connection.createStatement();<br/><font class="vuln_code">			statement.execute("INSERT INTO ACCOUNTS (USERID,ACCOUNT_NAME,BALANCE) VALUES ('"+username+"','"+acctType+"', 0)");</font><br/>			return null;<br/>		} catch (SQLException e){<br/>			return e.toString();<br/>		}<br/>	}<br/></pre></td></tr></tbody></table></div></td></tr><tr><td><a href="javascript:expandOrCollapse('note_7_2', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_7_2" border="0"/></a></td><td>Definitive</td><td>Injection.SQL</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\util\DBUtil.java</td><td align="right">375</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/89.html">89</a></td><td align="center"><a href="javascript:expandOrCollapse('note_7_2', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_7_2"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre><br/>	public static String addAccount(String username, String acctType) {<br/>		try {<br/>			Connection connection = getConnection();<br/>			Statement statement = connection.createStatement();<br/><font class="vuln_code">			statement.execute("INSERT INTO ACCOUNTS (USERID,ACCOUNT_NAME,BALANCE) VALUES ('"+username+"','"+acctType+"', 0)");</font><br/>			return null;<br/>		} catch (SQLException e){<br/>			return e.toString();<br/>		}<br/>	}<br/></pre></td></tr></tbody></table></div></td></tr></tbody></table><div class="fixGroupDivergenceAPI">com.ibm.security.appscan.altoromutual.util.DBUtil.addUser(java.lang.String;java.lang.String;java.lang.String;java.lang.String):java.lang.String</div><table width="100%"><tbody><tr vAlign="middle" align="left" bgColor="#444444"><th bgColor="white" width="1"/><th class="VulnTableHeader" width="40">Classification</th><th class="VulnTableHeader" width="40">Type</th><th class="VulnTableHeader" width="50">Severity</th><th class="VulnTableHeader" width="300">File</th><th class="VulnTableHeader" width="40" align="right">Line</th><th class="VulnTableHeader" width="75" align="right">CWE ID</th><th class="VulnTableHeader" width="75">Trace</th><th class="VulnTableHeader" width="75">Notes</th></tr><tr><td><a href="javascript:expandOrCollapse('note_7_1', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_7_1" border="0"/></a></td><td>Definitive</td><td>Injection.SQL</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\util\DBUtil.java</td><td align="right">386</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/89.html">89</a></td><td align="center"><a href="javascript:expandOrCollapse('note_7_1', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_7_1"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre><br/>	public static String addUser(String username, String password, String firstname, String lastname) {<br/>		try {<br/>			Connection connection = getConnection();<br/>			Statement statement = connection.createStatement();<br/><font class="vuln_code">			statement.execute("INSERT INTO PEOPLE (USER_ID,PASSWORD,FIRST_NAME,LAST_NAME,ROLE) VALUES ('"+username+"','"+password+"', '"+f</font><br/><font class="vuln_code">rstname+"', '"+lastname+"','user')");</font><br/>			return null;<br/>		} catch (SQLException e){<br/>			return e.toString();<br/>			<br/>		}<br/></pre></td></tr></tbody></table></div></td></tr><tr><td><a href="javascript:expandOrCollapse('note_7_2', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_7_2" border="0"/></a></td><td>Definitive</td><td>Injection.SQL</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\util\DBUtil.java</td><td align="right">386</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/89.html">89</a></td><td align="center"><a href="javascript:expandOrCollapse('note_7_2', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_7_2"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre><br/>	public static String addUser(String username, String password, String firstname, String lastname) {<br/>		try {<br/>			Connection connection = getConnection();<br/>			Statement statement = connection.createStatement();<br/><font class="vuln_code">			statement.execute("INSERT INTO PEOPLE (USER_ID,PASSWORD,FIRST_NAME,LAST_NAME,ROLE) VALUES ('"+username+"','"+password+"', '"+f</font><br/><font class="vuln_code">rstname+"', '"+lastname+"','user')");</font><br/>			return null;<br/>		} catch (SQLException e){<br/>			return e.toString();<br/>			<br/>		}<br/></pre></td></tr></tbody></table></div></td></tr><tr><td><a href="javascript:expandOrCollapse('note_7_3', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_7_3" border="0"/></a></td><td>Definitive</td><td>Injection.SQL</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\util\DBUtil.java</td><td align="right">386</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/89.html">89</a></td><td align="center"><a href="javascript:expandOrCollapse('note_7_3', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_7_3"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre><br/>	public static String addUser(String username, String password, String firstname, String lastname) {<br/>		try {<br/>			Connection connection = getConnection();<br/>			Statement statement = connection.createStatement();<br/><font class="vuln_code">			statement.execute("INSERT INTO PEOPLE (USER_ID,PASSWORD,FIRST_NAME,LAST_NAME,ROLE) VALUES ('"+username+"','"+password+"', '"+f</font><br/><font class="vuln_code">rstname+"', '"+lastname+"','user')");</font><br/>			return null;<br/>		} catch (SQLException e){<br/>			return e.toString();<br/>			<br/>		}<br/></pre></td></tr></tbody></table></div></td></tr><tr><td><a href="javascript:expandOrCollapse('note_7_4', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_7_4" border="0"/></a></td><td>Definitive</td><td>Injection.SQL</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\util\DBUtil.java</td><td align="right">386</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/89.html">89</a></td><td align="center"><a href="javascript:expandOrCollapse('note_7_4', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_7_4"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre><br/>	public static String addUser(String username, String password, String firstname, String lastname) {<br/>		try {<br/>			Connection connection = getConnection();<br/>			Statement statement = connection.createStatement();<br/><font class="vuln_code">			statement.execute("INSERT INTO PEOPLE (USER_ID,PASSWORD,FIRST_NAME,LAST_NAME,ROLE) VALUES ('"+username+"','"+password+"', '"+f</font><br/><font class="vuln_code">rstname+"', '"+lastname+"','user')");</font><br/>			return null;<br/>		} catch (SQLException e){<br/>			return e.toString();<br/>			<br/>		}<br/></pre></td></tr></tbody></table></div></td></tr></tbody></table><div class="fixGroupDivergenceAPI">com.ibm.security.appscan.altoromutual.util.DBUtil.changePassword(java.lang.String;java.lang.String):java.lang.String</div><table width="100%"><tbody><tr vAlign="middle" align="left" bgColor="#444444"><th bgColor="white" width="1"/><th class="VulnTableHeader" width="40">Classification</th><th class="VulnTableHeader" width="40">Type</th><th class="VulnTableHeader" width="50">Severity</th><th class="VulnTableHeader" width="300">File</th><th class="VulnTableHeader" width="40" align="right">Line</th><th class="VulnTableHeader" width="75" align="right">CWE ID</th><th class="VulnTableHeader" width="75">Trace</th><th class="VulnTableHeader" width="75">Notes</th></tr><tr><td><a href="javascript:expandOrCollapse('note_7_1', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_7_1" border="0"/></a></td><td>Definitive</td><td>Injection.SQL</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\util\DBUtil.java</td><td align="right">398</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/89.html">89</a></td><td align="center"><a href="javascript:expandOrCollapse('note_7_1', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_7_1"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>	<br/>	public static String changePassword(String username, String password) {<br/>		try {<br/>			Connection connection = getConnection();<br/>			Statement statement = connection.createStatement();<br/><font class="vuln_code">			statement.execute("UPDATE PEOPLE SET PASSWORD = '"+ password +"' WHERE USER_ID = '"+username+"'");</font><br/>			return null;<br/>		} catch (SQLException e){<br/>			return e.toString();<br/>			<br/>		}<br/></pre></td></tr></tbody></table></div></td></tr><tr><td><a href="javascript:expandOrCollapse('note_7_2', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_7_2" border="0"/></a></td><td>Definitive</td><td>Injection.SQL</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\util\DBUtil.java</td><td align="right">398</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/89.html">89</a></td><td align="center"><a href="javascript:expandOrCollapse('note_7_2', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_7_2"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>	<br/>	public static String changePassword(String username, String password) {<br/>		try {<br/>			Connection connection = getConnection();<br/>			Statement statement = connection.createStatement();<br/><font class="vuln_code">			statement.execute("UPDATE PEOPLE SET PASSWORD = '"+ password +"' WHERE USER_ID = '"+username+"'");</font><br/>			return null;<br/>		} catch (SQLException e){<br/>			return e.toString();<br/>			<br/>		}<br/></pre></td></tr></tbody></table></div></td></tr></tbody></table><div class="fixGroupDivergenceAPI">com.ibm.security.appscan.altoromutual.util.DBUtil.getAccounts(java.lang.String):com.ibm.security.appscan.altoromutual.model.Account[]</div><table width="100%"><tbody><tr vAlign="middle" align="left" bgColor="#444444"><th bgColor="white" width="1"/><th class="VulnTableHeader" width="40">Classification</th><th class="VulnTableHeader" width="40">Type</th><th class="VulnTableHeader" width="50">Severity</th><th class="VulnTableHeader" width="300">File</th><th class="VulnTableHeader" width="40" align="right">Line</th><th class="VulnTableHeader" width="75" align="right">CWE ID</th><th class="VulnTableHeader" width="75">Trace</th><th class="VulnTableHeader" width="75">Notes</th></tr><tr><td><a href="javascript:expandOrCollapse('note_7_1', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_7_1" border="0"/></a></td><td>Definitive</td><td>Injection.SQL</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\util\DBUtil.java</td><td align="right">180</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/89.html">89</a></td><td align="center"><a href="javascript:expandOrCollapse('note_7_1', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_7_1"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>		if (username == null || username.trim().length() == 0)<br/>			return null; <br/>		<br/>		Connection connection = getConnection();<br/>		Statement statement = connection.createStatement();<br/><font class="vuln_code">		ResultSet resultSet =statement.executeQuery("SELECT ACCOUNT_ID, ACCOUNT_NAME, BALANCE FROM ACCOUNTS WHERE USERID = '"+ username</font><br/><font class="vuln_code">+"' "); /* BAD - user input should always be sanitized */</font><br/><br/>		ArrayList&lt;Account&gt; accounts = new ArrayList&lt;Account&gt;(3);<br/>		while (resultSet.next()){<br/>			long accountId = resultSet.getLong("ACCOUNT_ID");<br/>			String name = resultSet.getString("ACCOUNT_NAME");<br/></pre></td></tr></tbody></table></div></td></tr><tr><td><a href="javascript:expandOrCollapse('note_7_2', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_7_2" border="0"/></a></td><td>Definitive</td><td>Injection.SQL</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\util\DBUtil.java</td><td align="right">180</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/89.html">89</a></td><td align="center"><a href="javascript:expandOrCollapse('note_7_2', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_7_2"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>		if (username == null || username.trim().length() == 0)<br/>			return null; <br/>		<br/>		Connection connection = getConnection();<br/>		Statement statement = connection.createStatement();<br/><font class="vuln_code">		ResultSet resultSet =statement.executeQuery("SELECT ACCOUNT_ID, ACCOUNT_NAME, BALANCE FROM ACCOUNTS WHERE USERID = '"+ username</font><br/><font class="vuln_code">+"' "); /* BAD - user input should always be sanitized */</font><br/><br/>		ArrayList&lt;Account&gt; accounts = new ArrayList&lt;Account&gt;(3);<br/>		while (resultSet.next()){<br/>			long accountId = resultSet.getLong("ACCOUNT_ID");<br/>			String name = resultSet.getString("ACCOUNT_NAME");<br/></pre></td></tr></tbody></table></div></td></tr><tr><td><a href="javascript:expandOrCollapse('note_7_3', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_7_3" border="0"/></a></td><td>Definitive</td><td>Injection.SQL</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\util\DBUtil.java</td><td align="right">180</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/89.html">89</a></td><td align="center"><a href="javascript:expandOrCollapse('note_7_3', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_7_3"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>		if (username == null || username.trim().length() == 0)<br/>			return null; <br/>		<br/>		Connection connection = getConnection();<br/>		Statement statement = connection.createStatement();<br/><font class="vuln_code">		ResultSet resultSet =statement.executeQuery("SELECT ACCOUNT_ID, ACCOUNT_NAME, BALANCE FROM ACCOUNTS WHERE USERID = '"+ username</font><br/><font class="vuln_code">+"' "); /* BAD - user input should always be sanitized */</font><br/><br/>		ArrayList&lt;Account&gt; accounts = new ArrayList&lt;Account&gt;(3);<br/>		while (resultSet.next()){<br/>			long accountId = resultSet.getLong("ACCOUNT_ID");<br/>			String name = resultSet.getString("ACCOUNT_NAME");<br/></pre></td></tr></tbody></table></div></td></tr><tr><td><a href="javascript:expandOrCollapse('note_7_4', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_7_4" border="0"/></a></td><td>Definitive</td><td>Injection.SQL</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\util\DBUtil.java</td><td align="right">180</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/89.html">89</a></td><td align="center"><a href="javascript:expandOrCollapse('note_7_4', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_7_4"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>		if (username == null || username.trim().length() == 0)<br/>			return null; <br/>		<br/>		Connection connection = getConnection();<br/>		Statement statement = connection.createStatement();<br/><font class="vuln_code">		ResultSet resultSet =statement.executeQuery("SELECT ACCOUNT_ID, ACCOUNT_NAME, BALANCE FROM ACCOUNTS WHERE USERID = '"+ username</font><br/><font class="vuln_code">+"' "); /* BAD - user input should always be sanitized */</font><br/><br/>		ArrayList&lt;Account&gt; accounts = new ArrayList&lt;Account&gt;(3);<br/>		while (resultSet.next()){<br/>			long accountId = resultSet.getLong("ACCOUNT_ID");<br/>			String name = resultSet.getString("ACCOUNT_NAME");<br/></pre></td></tr></tbody></table></div></td></tr><tr><td><a href="javascript:expandOrCollapse('note_7_5', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_7_5" border="0"/></a></td><td>Definitive</td><td>Injection.SQL</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\util\DBUtil.java</td><td align="right">180</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/89.html">89</a></td><td align="center"><a href="javascript:expandOrCollapse('note_7_5', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_7_5"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>		if (username == null || username.trim().length() == 0)<br/>			return null; <br/>		<br/>		Connection connection = getConnection();<br/>		Statement statement = connection.createStatement();<br/><font class="vuln_code">		ResultSet resultSet =statement.executeQuery("SELECT ACCOUNT_ID, ACCOUNT_NAME, BALANCE FROM ACCOUNTS WHERE USERID = '"+ username</font><br/><font class="vuln_code">+"' "); /* BAD - user input should always be sanitized */</font><br/><br/>		ArrayList&lt;Account&gt; accounts = new ArrayList&lt;Account&gt;(3);<br/>		while (resultSet.next()){<br/>			long accountId = resultSet.getLong("ACCOUNT_ID");<br/>			String name = resultSet.getString("ACCOUNT_NAME");<br/></pre></td></tr></tbody></table></div></td></tr><tr><td><a href="javascript:expandOrCollapse('note_7_6', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_7_6" border="0"/></a></td><td>Definitive</td><td>Injection.SQL</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\util\DBUtil.java</td><td align="right">180</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/89.html">89</a></td><td align="center"><a href="javascript:expandOrCollapse('note_7_6', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_7_6"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>		if (username == null || username.trim().length() == 0)<br/>			return null; <br/>		<br/>		Connection connection = getConnection();<br/>		Statement statement = connection.createStatement();<br/><font class="vuln_code">		ResultSet resultSet =statement.executeQuery("SELECT ACCOUNT_ID, ACCOUNT_NAME, BALANCE FROM ACCOUNTS WHERE USERID = '"+ username</font><br/><font class="vuln_code">+"' "); /* BAD - user input should always be sanitized */</font><br/><br/>		ArrayList&lt;Account&gt; accounts = new ArrayList&lt;Account&gt;(3);<br/>		while (resultSet.next()){<br/>			long accountId = resultSet.getLong("ACCOUNT_ID");<br/>			String name = resultSet.getString("ACCOUNT_NAME");<br/></pre></td></tr></tbody></table></div></td></tr><tr><td><a href="javascript:expandOrCollapse('note_7_7', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_7_7" border="0"/></a></td><td>Definitive</td><td>Injection.SQL</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\util\DBUtil.java</td><td align="right">180</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/89.html">89</a></td><td align="center"><a href="javascript:expandOrCollapse('note_7_7', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_7_7"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>		if (username == null || username.trim().length() == 0)<br/>			return null; <br/>		<br/>		Connection connection = getConnection();<br/>		Statement statement = connection.createStatement();<br/><font class="vuln_code">		ResultSet resultSet =statement.executeQuery("SELECT ACCOUNT_ID, ACCOUNT_NAME, BALANCE FROM ACCOUNTS WHERE USERID = '"+ username</font><br/><font class="vuln_code">+"' "); /* BAD - user input should always be sanitized */</font><br/><br/>		ArrayList&lt;Account&gt; accounts = new ArrayList&lt;Account&gt;(3);<br/>		while (resultSet.next()){<br/>			long accountId = resultSet.getLong("ACCOUNT_ID");<br/>			String name = resultSet.getString("ACCOUNT_NAME");<br/></pre></td></tr></tbody></table></div></td></tr></tbody></table><div class="fixGroupDivergenceAPI">com.ibm.security.appscan.altoromutual.util.DBUtil.getTransactions(java.lang.String;java.lang.String;com.ibm.security.appscan.altoromutual.model.Account[];int):com.ibm.security.appscan.altoromutual.model.Transaction[]</div><table width="100%"><tbody><tr vAlign="middle" align="left" bgColor="#444444"><th bgColor="white" width="1"/><th class="VulnTableHeader" width="40">Classification</th><th class="VulnTableHeader" width="40">Type</th><th class="VulnTableHeader" width="50">Severity</th><th class="VulnTableHeader" width="300">File</th><th class="VulnTableHeader" width="40" align="right">Line</th><th class="VulnTableHeader" width="75" align="right">CWE ID</th><th class="VulnTableHeader" width="75">Trace</th><th class="VulnTableHeader" width="75">Notes</th></tr><tr><td><a href="javascript:expandOrCollapse('note_7_1', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_7_1" border="0"/></a></td><td>Definitive</td><td>Injection.SQL</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\util\DBUtil.java</td><td align="right">307</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/89.html">89</a></td><td align="center"><a href="javascript:expandOrCollapse('note_7_1', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_7_1"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>			<br/>			String query = "SELECT * FROM TRANSACTIONS WHERE (" + acctIds.toString() + ") " + ((dateString==null)?"": "AND (" + dateString<br/>+ ") ") + "ORDER BY DATE DESC" ;<br/>			ResultSet resultSet = null;<br/>			<br/>			try {<br/><font class="vuln_code">				resultSet = statement.executeQuery(query);</font><br/>			} catch (SQLException e){<br/>				int errorCode = e.getErrorCode();<br/>				if (errorCode == 30000)<br/>					throw new SQLException("Date-time query must be in the format of yyyy-mm-dd HH:mm:ss");<br/>				<br/></pre></td></tr></tbody></table></div></td></tr><tr><td><a href="javascript:expandOrCollapse('note_7_2', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_7_2" border="0"/></a></td><td>Definitive</td><td>Injection.SQL</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\util\DBUtil.java</td><td align="right">307</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/89.html">89</a></td><td align="center"><a href="javascript:expandOrCollapse('note_7_2', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_7_2"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>			<br/>			String query = "SELECT * FROM TRANSACTIONS WHERE (" + acctIds.toString() + ") " + ((dateString==null)?"": "AND (" + dateString<br/>+ ") ") + "ORDER BY DATE DESC" ;<br/>			ResultSet resultSet = null;<br/>			<br/>			try {<br/><font class="vuln_code">				resultSet = statement.executeQuery(query);</font><br/>			} catch (SQLException e){<br/>				int errorCode = e.getErrorCode();<br/>				if (errorCode == 30000)<br/>					throw new SQLException("Date-time query must be in the format of yyyy-mm-dd HH:mm:ss");<br/>				<br/></pre></td></tr></tbody></table></div></td></tr><tr><td><a href="javascript:expandOrCollapse('note_7_3', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_7_3" border="0"/></a></td><td>Definitive</td><td>Injection.SQL</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\util\DBUtil.java</td><td align="right">307</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/89.html">89</a></td><td align="center"><a href="javascript:expandOrCollapse('note_7_3', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_7_3"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>			<br/>			String query = "SELECT * FROM TRANSACTIONS WHERE (" + acctIds.toString() + ") " + ((dateString==null)?"": "AND (" + dateString<br/>+ ") ") + "ORDER BY DATE DESC" ;<br/>			ResultSet resultSet = null;<br/>			<br/>			try {<br/><font class="vuln_code">				resultSet = statement.executeQuery(query);</font><br/>			} catch (SQLException e){<br/>				int errorCode = e.getErrorCode();<br/>				if (errorCode == 30000)<br/>					throw new SQLException("Date-time query must be in the format of yyyy-mm-dd HH:mm:ss");<br/>				<br/></pre></td></tr></tbody></table></div></td></tr></tbody></table><div class="fixGroupDivergenceAPI">com.ibm.security.appscan.altoromutual.util.DBUtil.isValidUser(java.lang.String;java.lang.String):boolean</div><table width="100%"><tbody><tr vAlign="middle" align="left" bgColor="#444444"><th bgColor="white" width="1"/><th class="VulnTableHeader" width="40">Classification</th><th class="VulnTableHeader" width="40">Type</th><th class="VulnTableHeader" width="50">Severity</th><th class="VulnTableHeader" width="300">File</th><th class="VulnTableHeader" width="40" align="right">Line</th><th class="VulnTableHeader" width="75" align="right">CWE ID</th><th class="VulnTableHeader" width="75">Trace</th><th class="VulnTableHeader" width="75">Notes</th></tr><tr><td><a href="javascript:expandOrCollapse('note_7_1', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_7_1" border="0"/></a></td><td>Definitive</td><td>Injection.SQL</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\util\DBUtil.java</td><td align="right">123</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/89.html">89</a></td><td align="center"><a href="javascript:expandOrCollapse('note_7_1', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_7_1"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>			return false; <br/>		<br/>		Connection connection = getConnection();<br/>		Statement statement = connection.createStatement();<br/>		<br/><font class="vuln_code">		ResultSet resultSet =statement.executeQuery("SELECT COUNT(*)FROM PEOPLE WHERE USER_ID = '"+ user +"' AND PASSWORD='" + password</font><br/><font class="vuln_code">+ "'"); /* BAD - user input should always be sanitized */</font><br/>		<br/>		if (resultSet.next()){<br/>			<br/>				if (resultSet.getInt(1) &gt; 0)<br/>					return true;<br/></pre></td></tr></tbody></table></div></td></tr><tr><td><a href="javascript:expandOrCollapse('note_7_2', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_7_2" border="0"/></a></td><td>Definitive</td><td>Injection.SQL</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\util\DBUtil.java</td><td align="right">123</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/89.html">89</a></td><td align="center"><a href="javascript:expandOrCollapse('note_7_2', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_7_2"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>			return false; <br/>		<br/>		Connection connection = getConnection();<br/>		Statement statement = connection.createStatement();<br/>		<br/><font class="vuln_code">		ResultSet resultSet =statement.executeQuery("SELECT COUNT(*)FROM PEOPLE WHERE USER_ID = '"+ user +"' AND PASSWORD='" + password</font><br/><font class="vuln_code">+ "'"); /* BAD - user input should always be sanitized */</font><br/>		<br/>		if (resultSet.next()){<br/>			<br/>				if (resultSet.getInt(1) &gt; 0)<br/>					return true;<br/></pre></td></tr></tbody></table></div></td></tr></tbody></table><div class="fixGroupDivergenceAPI">com.ibm.security.appscan.altoromutual.util.DBUtil.transferFunds(java.lang.String;long;long;double):java.lang.String</div><table width="100%"><tbody><tr vAlign="middle" align="left" bgColor="#444444"><th bgColor="white" width="1"/><th class="VulnTableHeader" width="40">Classification</th><th class="VulnTableHeader" width="40">Type</th><th class="VulnTableHeader" width="50">Severity</th><th class="VulnTableHeader" width="300">File</th><th class="VulnTableHeader" width="40" align="right">Line</th><th class="VulnTableHeader" width="75" align="right">CWE ID</th><th class="VulnTableHeader" width="75">Trace</th><th class="VulnTableHeader" width="75">Notes</th></tr><tr><td><a href="javascript:expandOrCollapse('note_7_1', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_7_1" border="0"/></a></td><td>Definitive</td><td>Injection.SQL</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\util\DBUtil.java</td><td align="right">146</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/89.html">89</a></td><td align="center"><a href="javascript:expandOrCollapse('note_7_1', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_7_1"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>		if (username == null || username.trim().length() == 0)<br/>			return null; <br/>		<br/>		Connection connection = getConnection();<br/>		Statement statement = connection.createStatement();<br/><font class="vuln_code">		ResultSet resultSet =statement.executeQuery("SELECT FIRST_NAME,LAST_NAME,ROLE FROM PEOPLE WHERE USER_ID = '"+ username +"' "); </font><br/><font class="vuln_code">* BAD - user input should always be sanitized */</font><br/><br/>		String firstName = null;<br/>		String lastName = null;<br/>		String roleString = null;<br/>		if (resultSet.next()){<br/></pre></td></tr></tbody></table></div></td></tr><tr><td><a href="javascript:expandOrCollapse('note_7_2', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_7_2" border="0"/></a></td><td>Suspect</td><td>Injection.SQL</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\util\DBUtil.java</td><td align="right">180</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/89.html">89</a></td><td align="center"><a href="javascript:expandOrCollapse('note_7_2', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_7_2"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>		if (username == null || username.trim().length() == 0)<br/>			return null; <br/>		<br/>		Connection connection = getConnection();<br/>		Statement statement = connection.createStatement();<br/><font class="vuln_code">		ResultSet resultSet =statement.executeQuery("SELECT ACCOUNT_ID, ACCOUNT_NAME, BALANCE FROM ACCOUNTS WHERE USERID = '"+ username</font><br/><font class="vuln_code">+"' "); /* BAD - user input should always be sanitized */</font><br/><br/>		ArrayList&lt;Account&gt; accounts = new ArrayList&lt;Account&gt;(3);<br/>		while (resultSet.next()){<br/>			long accountId = resultSet.getLong("ACCOUNT_ID");<br/>			String name = resultSet.getString("ACCOUNT_NAME");<br/></pre></td></tr><tr><td class="trace"><table cellpadding="0" cellspacing="0"><thead><tr><th class="traceheader" align="left">Method</th><th class="traceheader" align="left">File</th><th class="traceheader" align="right" width="75">Line</th><th class="traceheader" align="right" width="85">Tainted Arg</th></tr></thead><tbody><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td/><td><img src="resource/images/method.gif"/></td><td>&nbsp;com.ibm.security.appscan.altoromutual.servlet.TransferServlet.doPost&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\servlet\TransferServlet.java</td><td align="right">52</td><td align="right"/></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_middle.gif"/></td><td><img src="resource/images/iotsource.gif"/></td><td>&nbsp;javax.servlet.http.HttpSession.getAttribute&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\servlet\TransferServlet.java</td><td align="right">52</td><td align="right">return val</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_middle.gif"/></td><td><img src="resource/images/method.gif"/></td><td>&nbsp;com.ibm.security.appscan.altoromutual.model.User.getUsername&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\servlet\TransferServlet.java</td><td align="right">56</td><td align="right">user</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_bottom.gif"/></td><td><img src="resource/images/method.gif"/></td><td>&nbsp;com.ibm.security.appscan.altoromutual.util.DBUtil.transferFunds&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\servlet\TransferServlet.java</td><td align="right">108</td><td align="right">userName</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_spacer.gif"/><td><img src="resource/images/trace_tree_middle.gif"/></td></td><td><img src="resource/images/method.gif"/></td><td>&nbsp;com.ibm.security.appscan.altoromutual.util.DBUtil.getUserInfo&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\util\DBUtil.java</td><td align="right">206</td><td align="right">username</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_spacer.gif"/><td><img src="resource/images/trace_tree_bottom.gif"/></td></td><td><img src="resource/images/method.gif"/></td><td>&nbsp;com.ibm.security.appscan.altoromutual.model.User.getCreditCardNumber&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\util\DBUtil.java</td><td align="right">226</td><td align="right">user</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_spacer.gif"/><td><img src="resource/images/trace_tree_spacer.gif"/><td><img src="resource/images/trace_tree_bottom.gif"/></td></td></td><td><img src="resource/images/method.gif"/></td><td>&nbsp;com.ibm.security.appscan.altoromutual.model.User.getAccounts&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\model\User.java</td><td align="right">77</td><td align="right">this</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_spacer.gif"/><td><img src="resource/images/trace_tree_spacer.gif"/><td><img src="resource/images/trace_tree_spacer.gif"/><td><img src="resource/images/trace_tree_bottom.gif"/></td></td></td></td><td><img src="resource/images/method.gif"/></td><td>&nbsp;com.ibm.security.appscan.altoromutual.util.DBUtil.getAccounts&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\model\User.java</td><td align="right">69</td><td align="right">this . use</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_spacer.gif"/><td><img src="resource/images/trace_tree_spacer.gif"/><td><img src="resource/images/trace_tree_spacer.gif"/><td><img src="resource/images/trace_tree_spacer.gif"/><td><img src="resource/images/trace_tree_middle.gif"/></td></td></td></td></td><td><img src="resource/images/methodNotValidator.gif"/></td><td>&nbsp;java.lang.StringBuilder.append&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\util\DBUtil.java</td><td align="right">180</td><td align="right">username</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_spacer.gif"/><td><img src="resource/images/trace_tree_spacer.gif"/><td><img src="resource/images/trace_tree_spacer.gif"/><td><img src="resource/images/trace_tree_spacer.gif"/><td><img src="resource/images/trace_tree_middle.gif"/></td></td></td></td></td><td><img src="resource/images/methodNotValidator.gif"/></td><td>&nbsp;java.lang.StringBuilder.append&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\util\DBUtil.java</td><td align="right">180</td><td align="right">new java.l</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_spacer.gif"/><td><img src="resource/images/trace_tree_spacer.gif"/><td><img src="resource/images/trace_tree_spacer.gif"/><td><img src="resource/images/trace_tree_spacer.gif"/><td><img src="resource/images/trace_tree_middle.gif"/></td></td></td></td></td><td><img src="resource/images/methodNotValidator.gif"/></td><td>&nbsp;java.lang.StringBuilder.toString&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\util\DBUtil.java</td><td align="right">180</td><td align="right">new java.l</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_spacer.gif"/><td><img src="resource/images/trace_tree_spacer.gif"/><td><img src="resource/images/trace_tree_spacer.gif"/><td><img src="resource/images/trace_tree_spacer.gif"/><td><img src="resource/images/trace_tree_bottom.gif"/></td></td></td></td></td><td><img src="resource/images/methodTraceSink.gif"/></td><td>&nbsp;java.sql.Statement.executeQuery&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\util\DBUtil.java</td><td align="right">180</td><td align="right">new java.l</td></tr></tbody></table></td></tr></tbody></table></div></td></tr></tbody></table><div class="findingHeader">Common Fix Point: Validation.Required</div><div class="fixGroupDivergenceAPI">javax.servlet.http.HttpSession.setAttribute(java.lang.String;java.lang.Object):void</div><table width="100%"><tbody><tr vAlign="middle" align="left" bgColor="#444444"><th bgColor="white" width="1"/><th class="VulnTableHeader" width="40">Classification</th><th class="VulnTableHeader" width="40">Type</th><th class="VulnTableHeader" width="50">Severity</th><th class="VulnTableHeader" width="300">File</th><th class="VulnTableHeader" width="40" align="right">Line</th><th class="VulnTableHeader" width="75" align="right">CWE ID</th><th class="VulnTableHeader" width="75">Trace</th><th class="VulnTableHeader" width="75">Notes</th></tr><tr><td><a href="javascript:expandOrCollapse('note_8_1', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_8_1" border="0"/></a></td><td>Suspect</td><td>Validation.Required</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\servlet\AdminServlet.java</td><td align="right">109</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/20.html">20</a></td><td align="center"><a href="javascript:expandOrCollapse('note_8_1', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_8_1"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>		if (message != null)<br/>			message = "Error: " + message;<br/>		else<br/>			message = "Requested operation has completed successfully.";<br/>		<br/><font class="vuln_code">		request.getSession().setAttribute("message", message);</font><br/>		response.sendRedirect("admin.jsp");<br/>		return ;<br/>	}<br/><br/>}<br/></pre></td></tr><tr><td class="trace"><table cellpadding="0" cellspacing="0"><thead><tr><th class="traceheader" align="left">Method</th><th class="traceheader" align="left">File</th><th class="traceheader" align="right" width="75">Line</th><th class="traceheader" align="right" width="85">Tainted Arg</th></tr></thead><tbody><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td/><td><img src="resource/images/method.gif"/></td><td>&nbsp;com.ibm.security.appscan.altoromutual.servlet.AdminServlet.doPost&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\servlet\AdminServlet.java</td><td align="right">94</td><td align="right"/></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_middle.gif"/></td><td><img src="resource/images/method.gif"/></td><td>&nbsp;com.ibm.security.appscan.altoromutual.util.DBUtil.changePassword&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\servlet\AdminServlet.java</td><td align="right">94</td><td align="right">return val</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_extender.gif"/><td><img src="resource/images/trace_tree_bottom.gif"/></td></td><td><img src="resource/images/iotsource.gif"/></td><td>&nbsp;java.lang.Throwable.toString&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\util\DBUtil.java</td><td align="right">401</td><td align="right">return val</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_middle.gif"/></td><td><img src="resource/images/methodNotValidator.gif"/></td><td>&nbsp;java.lang.StringBuilder.append&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\servlet\AdminServlet.java</td><td align="right">105</td><td align="right">message</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_middle.gif"/></td><td><img src="resource/images/methodNotValidator.gif"/></td><td>&nbsp;java.lang.StringBuilder.toString&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\servlet\AdminServlet.java</td><td align="right">105</td><td align="right">new java.l</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_bottom.gif"/></td><td><img src="resource/images/methodTraceSink.gif"/></td><td>&nbsp;javax.servlet.http.HttpSession.setAttribute&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\servlet\AdminServlet.java</td><td align="right">109</td><td align="right">message</td></tr></tbody></table></td></tr></tbody></table></div></td></tr><tr><td><a href="javascript:expandOrCollapse('note_8_2', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_8_2" border="0"/></a></td><td>Suspect</td><td>Validation.Required</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\servlet\AdminServlet.java</td><td align="right">109</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/20.html">20</a></td><td align="center"><a href="javascript:expandOrCollapse('note_8_2', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_8_2"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>		if (message != null)<br/>			message = "Error: " + message;<br/>		else<br/>			message = "Requested operation has completed successfully.";<br/>		<br/><font class="vuln_code">		request.getSession().setAttribute("message", message);</font><br/>		response.sendRedirect("admin.jsp");<br/>		return ;<br/>	}<br/><br/>}<br/></pre></td></tr><tr><td class="trace"><table cellpadding="0" cellspacing="0"><thead><tr><th class="traceheader" align="left">Method</th><th class="traceheader" align="left">File</th><th class="traceheader" align="right" width="75">Line</th><th class="traceheader" align="right" width="85">Tainted Arg</th></tr></thead><tbody><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td/><td><img src="resource/images/method.gif"/></td><td>&nbsp;com.ibm.security.appscan.altoromutual.servlet.AdminServlet.doPost&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\servlet\AdminServlet.java</td><td align="right">40</td><td align="right"/></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_middle.gif"/></td><td><img src="resource/images/method.gif"/></td><td>&nbsp;com.ibm.security.appscan.altoromutual.util.DBUtil.addAccount&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\servlet\AdminServlet.java</td><td align="right">40</td><td align="right">return val</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_extender.gif"/><td><img src="resource/images/trace_tree_bottom.gif"/></td></td><td><img src="resource/images/iotsource.gif"/></td><td>&nbsp;java.lang.Throwable.toString&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\util\DBUtil.java</td><td align="right">378</td><td align="right">return val</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_middle.gif"/></td><td><img src="resource/images/methodNotValidator.gif"/></td><td>&nbsp;java.lang.StringBuilder.append&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\servlet\AdminServlet.java</td><td align="right">105</td><td align="right">message</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_middle.gif"/></td><td><img src="resource/images/methodNotValidator.gif"/></td><td>&nbsp;java.lang.StringBuilder.toString&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\servlet\AdminServlet.java</td><td align="right">105</td><td align="right">new java.l</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_bottom.gif"/></td><td><img src="resource/images/methodTraceSink.gif"/></td><td>&nbsp;javax.servlet.http.HttpSession.setAttribute&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\servlet\AdminServlet.java</td><td align="right">109</td><td align="right">message</td></tr></tbody></table></td></tr></tbody></table></div></td></tr><tr><td><a href="javascript:expandOrCollapse('note_8_3', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_8_3" border="0"/></a></td><td>Suspect</td><td>Validation.Required</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\servlet\AdminServlet.java</td><td align="right">109</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/20.html">20</a></td><td align="center"><a href="javascript:expandOrCollapse('note_8_3', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_8_3"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>		if (message != null)<br/>			message = "Error: " + message;<br/>		else<br/>			message = "Requested operation has completed successfully.";<br/>		<br/><font class="vuln_code">		request.getSession().setAttribute("message", message);</font><br/>		response.sendRedirect("admin.jsp");<br/>		return ;<br/>	}<br/><br/>}<br/></pre></td></tr><tr><td class="trace"><table cellpadding="0" cellspacing="0"><thead><tr><th class="traceheader" align="left">Method</th><th class="traceheader" align="left">File</th><th class="traceheader" align="right" width="75">Line</th><th class="traceheader" align="right" width="85">Tainted Arg</th></tr></thead><tbody><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td/><td><img src="resource/images/method.gif"/></td><td>&nbsp;com.ibm.security.appscan.altoromutual.servlet.AdminServlet.doPost&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\servlet\AdminServlet.java</td><td align="right">71</td><td align="right"/></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_middle.gif"/></td><td><img src="resource/images/method.gif"/></td><td>&nbsp;com.ibm.security.appscan.altoromutual.util.DBUtil.addUser&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\servlet\AdminServlet.java</td><td align="right">71</td><td align="right">return val</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_extender.gif"/><td><img src="resource/images/trace_tree_bottom.gif"/></td></td><td><img src="resource/images/iotsource.gif"/></td><td>&nbsp;java.lang.Throwable.toString&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\util\DBUtil.java</td><td align="right">389</td><td align="right">return val</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_middle.gif"/></td><td><img src="resource/images/methodNotValidator.gif"/></td><td>&nbsp;java.lang.StringBuilder.append&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\servlet\AdminServlet.java</td><td align="right">105</td><td align="right">message</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_middle.gif"/></td><td><img src="resource/images/methodNotValidator.gif"/></td><td>&nbsp;java.lang.StringBuilder.toString&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\servlet\AdminServlet.java</td><td align="right">105</td><td align="right">new java.l</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_bottom.gif"/></td><td><img src="resource/images/methodTraceSink.gif"/></td><td>&nbsp;javax.servlet.http.HttpSession.setAttribute&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\servlet\AdminServlet.java</td><td align="right">109</td><td align="right">message</td></tr></tbody></table></td></tr></tbody></table></div></td></tr></tbody></table><div class="findingHeader">Common Fix Point: Validation.Required.URL.Redirect</div><div class="fixGroupDivergenceAPI">java.lang.StringBuilder.append(java.lang.String):java.lang.StringBuilder</div><table width="100%"><tbody><tr vAlign="middle" align="left" bgColor="#444444"><th bgColor="white" width="1"/><th class="VulnTableHeader" width="40">Classification</th><th class="VulnTableHeader" width="40">Type</th><th class="VulnTableHeader" width="50">Severity</th><th class="VulnTableHeader" width="300">File</th><th class="VulnTableHeader" width="40" align="right">Line</th><th class="VulnTableHeader" width="75" align="right">CWE ID</th><th class="VulnTableHeader" width="75">Trace</th><th class="VulnTableHeader" width="75">Notes</th></tr><tr><td><a href="javascript:expandOrCollapse('note_9_1', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_9_1" border="0"/></a></td><td>Definitive</td><td>Validation.Required.URL.Redirect</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\servlet\AccountViewServlet.java</td><td align="right">44</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/601.html">601</a></td><td align="center"><a href="javascript:expandOrCollapse('note_9_1', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_9_1"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>	protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {<br/>		//show account balance for a particular account<br/>		if (request.getRequestURL().toString().endsWith("showAccount")){<br/>			String accountName = request.getParameter("listAccounts");<br/>			if (accountName == null){<br/><font class="vuln_code">				response.sendRedirect(request.getContextPath()+"/bank/main.jsp");</font><br/>				return;<br/>			}<br/>//			response.sendRedirect("/bank/balance.jsp&amp;acctId=" + accountName);<br/>			RequestDispatcher dispatcher = request.getRequestDispatcher("/bank/balance.jsp?acctId=" + accountName);<br/>			dispatcher.forward(request, response);<br/></pre></td></tr></tbody></table></div></td></tr><tr><td><a href="javascript:expandOrCollapse('note_9_2', minusIcon, plusIcon)"><img src="resource/images/foldingPlus.gif" id="img_note_9_2" border="0"/></a></td><td>Suspect</td><td>Validation.Required.URL.Redirect</td><td><img src="resource/images/red-light-sm.gif"/></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\servlet\AccountViewServlet.java</td><td align="right">44</td><td align="right"><a href="http://cwe.mitre.org/data/definitions/601.html">601</a></td><td align="center"><a href="javascript:expandOrCollapse('note_9_2', minusIcon, plusIcon)"><img src="resource/images/iotrace.gif" border="0"/></a></td><td align="center"/></tr><tr><td colspan="8"><div class="hidden" id="div_note_9_2"><table><tbody><tr><td valign="top" rowspan="100"><img src="resource/images/note_arm.gif"/></td></tr><tr><td class="code"><pre>	protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {<br/>		//show account balance for a particular account<br/>		if (request.getRequestURL().toString().endsWith("showAccount")){<br/>			String accountName = request.getParameter("listAccounts");<br/>			if (accountName == null){<br/><font class="vuln_code">				response.sendRedirect(request.getContextPath()+"/bank/main.jsp");</font><br/>				return;<br/>			}<br/>//			response.sendRedirect("/bank/balance.jsp&amp;acctId=" + accountName);<br/>			RequestDispatcher dispatcher = request.getRequestDispatcher("/bank/balance.jsp?acctId=" + accountName);<br/>			dispatcher.forward(request, response);<br/></pre></td></tr><tr><td class="trace"><table cellpadding="0" cellspacing="0"><thead><tr><th class="traceheader" align="left">Method</th><th class="traceheader" align="left">File</th><th class="traceheader" align="right" width="75">Line</th><th class="traceheader" align="right" width="85">Tainted Arg</th></tr></thead><tbody><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td/><td><img src="resource/images/method.gif"/></td><td>&nbsp;com.ibm.security.appscan.altoromutual.servlet.AccountViewServlet.doGet&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\servlet\AccountViewServlet.java</td><td align="right">56</td><td align="right"/></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_middle.gif"/></td><td><img src="resource/images/iotsource.gif"/></td><td>&nbsp;javax.servlet.http.HttpServlet.doGet&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\servlet\AccountViewServlet.java</td><td align="right">56</td><td align="right">request</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_middle.gif"/></td><td><img src="resource/images/methodNotValidator.gif"/></td><td>&nbsp;javax.servlet.http.HttpServletRequest.getContextPath&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\servlet\AccountViewServlet.java</td><td align="right">44</td><td align="right">request</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_middle.gif"/></td><td><img src="resource/images/methodNotValidator.gif"/></td><td>&nbsp;java.lang.String.valueOf&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\servlet\AccountViewServlet.java</td><td align="right">44</td><td align="right">request . </td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_middle.gif"/></td><td><img src="resource/images/methodPropagator.gif"/></td><td>&nbsp;java.lang.StringBuilder.&lt;init&gt;&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\servlet\AccountViewServlet.java</td><td align="right">44</td><td align="right">java.lang.</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_middle.gif"/></td><td><img src="resource/images/methodNotValidator.gif"/></td><td>&nbsp;java.lang.StringBuilder.append&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\servlet\AccountViewServlet.java</td><td align="right">44</td><td align="right">new java.l</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_middle.gif"/></td><td><img src="resource/images/methodNotValidator.gif"/></td><td>&nbsp;java.lang.StringBuilder.toString&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\servlet\AccountViewServlet.java</td><td align="right">44</td><td align="right">new java.l</td></tr><tr><td><table cellpadding="0" cellspacing="0"><tr valign="middle"><td><img src="resource/images/trace_tree_bottom.gif"/></td><td><img src="resource/images/methodTraceSink.gif"/></td><td>&nbsp;javax.servlet.http.HttpServletResponse.sendRedirect&nbsp;</td></tr></table></td><td>C:\Sample Applications\AltoroJ_ant\src\com\ibm\security\appscan\altoromutual\servlet\AccountViewServlet.java</td><td align="right">44</td><td align="right">new java.l</td></tr></tbody></table></td></tr></tbody></table></div></td></tr></tbody></table></body></html>